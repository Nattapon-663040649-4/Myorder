# Project: The Historical Court (Multi-Agent System)

## สรุปภาพรวมโปรเจกต์

โปรเจกต์นี้คือการสร้างระบบ **Multi-Agent System (MAS)** ด้วย **Google ADK** เพื่อจำลองการทำงานของ "ศาล" ในการวิเคราะห์ข้อมูลประวัติศาสตร์ โดยเป้าหมายคือการให้ Agent ไปค้นหาข้อมูลจาก Wikipedia ในมุมมองที่ต่างกัน (ทั้งด้านดีและด้านเสีย) แล้วนำมาสรุปเป็นรายงานที่เป็นกลางที่สุดให้เราครับ

---

## โครงสร้างการทำงานของ Agent (Workflow)

ผมแบ่งลำดับการทำงานออกเป็น 4 ขั้นตอนตามโจทย์เป๊ะๆ ดังนี้ครับ:

### **Step 1: The Inquiry (Sequential)**

* **Agent:** `inquiry_clerk`
* **หน้าที่:** เป็นตัวแรกที่ออกมาทักทายเรา และถามว่าเราอยากให้ศาลวิเคราะห์เรื่องอะไร (เช่น Napoleon หรือ Cold War) จากนั้นจะเก็บชื่อหัวข้อไว้ในตัวแปร `SUBJECT_TOPIC` เพื่อส่งต่อให้ทีม Agent ตัวต่อไปครับ

### **Step 2: The Investigation (Parallel)**

ขั้นตอนนี้ระบบจะแยกกันไปทำงานแบบขนาน (Parallel) เพื่อประหยัดเวลาและแยกมุมมองข้อมูลครับ:

* **The Admirer (ฝั่งชม):** จะไปขุด Wikipedia โดยเน้น Keyword พวก `achievements` หรือ `success` แล้วสรุปสั้นๆ เก็บไว้ที่ `pos_data`
* **The Critic (ฝั่งค้าน):** จะไปหาข้อมูลในแง่ `controversy` หรือ `criticism` แล้วสรุปเก็บไว้ที่ `neg_data`

### **Step 3: The Trial & Review (Loop)**

* **The Judge (Agent C):** รับหน้าที่เป็นตัวตัดสิน โดยจะดูข้อมูลใน `pos_data` และ `neg_data` ว่ามันโอเคหรือยัง
* **การทำงาน:** ถ้า Judge มองว่าข้อมูลฝั่งใดฝั่งหนึ่งน้อยไป หรือข้อมูลดูไม่แฟร์ จะสั่งให้ Researcher วนลูปกลับไปหามาใหม่ (สูงสุด 3 รอบ)
* **การจบงาน:** เมื่อข้อมูลสมดุลแล้ว Judge จะเรียกใช้ Tool **`exit_loop`** เพื่อสั่งจบการสืบพยานทันทีครับ

### **Step 4: The Verdict (Output)**

* **Agent:** `verdict_scribe`
* **หน้าที่:** นำข้อมูลจากทั้งสองฝั่งที่ Judge อนุมัติแล้ว มาเขียนเรียบเรียงเป็นรายงานวิชาการที่แบ่งเป็นส่วนๆ (Intro, Success, Controversies, Conclusion)
* **การบันทึก:** ใช้ Tool `export_verdict_to_txt` เซฟไฟล์ออกมาเป็น **.txt** ลงในโฟลเดอร์ `historical_court_reports/` ให้เราโดยอัตโนมัติครับ

---

## เทคนิคที่ใช้ (Technical Implementation)

* **State Management:** มีการใช้ Session State แยก Key ชัดเจน (`pos_data`, `neg_data`) เพื่อไม่ให้ข้อมูลปนกัน
* **Summarization:** สั่งให้ Agent สรุปเนื้อหาก่อนเซฟลง State เพื่อป้องกันปัญหาข้อมูลยาวเกินไปจนระบบค้าง (Unknown Error)
* **Tool Logic:** ใช้เครื่องมือ `exit_loop` ในการจบการทำงานตามข้อกำหนดของอาจารย์ครับ

---

## วิธีการใช้งาน

1. ตั้งค่า API Key และชื่อ Model ในไฟล์ `.env`
2. รันคำสั่ง `adk web agent.py`
3. ใส่หัวข้อที่ต้องการ แล้วรอรับไฟล์สรุปในโฟลเดอร์ผลลัพธ์ได้เลยครับ
